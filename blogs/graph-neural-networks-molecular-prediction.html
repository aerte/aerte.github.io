<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graph Neural Networks for Molecular Property Prediction - Felix Aertebjerg</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'space-grotesk': ['Space Grotesk', 'sans-serif'],
                    },
                    colors: {
                        'accent-purple': '#8b5cf6',
                        'accent-blue': '#3b82f6',
                        'accent-cyan': '#06b6d4',
                        'accent-pink': '#ec4899',
                        'accent-orange': '#f59e0b',
                    }
                }
            }
        }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <!-- MathJax for math formulas -->
    <script>
        window.MathJax = {
            tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]},
            svg: {fontCache: 'global'}
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    <style>
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #ffffff;
        }
        ::-webkit-scrollbar-thumb {
            background: #e2e8f0;
            border-radius: 5px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #8b5cf6;
        }

        /* Selection */
        ::selection {
            background: rgba(139, 92, 246, 0.2);
            color: #1a202c;
        }

        /* Prose styling for blog content */
        .prose {
            color: #374151;
        }
        .prose h4 {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.75rem;
        }
        .prose p {
            margin-bottom: 1rem;
        }
        .prose pre {
            background: #1f2937 !important;
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-x: auto;
            margin: 1.5rem 0;
        }
        .prose code {
            background: #f1f5f9;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-size: 0.875em;
            font-family: 'Courier New', monospace;
        }
        .prose pre code {
            background: transparent;
            padding: 0;
            border-radius: 0;
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
    </style>
</head>
<body class="bg-white text-slate-900 font-space-grotesk font-medium leading-relaxed min-h-screen antialiased">
    <!-- Navigation -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-10">
        <div class="max-w-4xl mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <a href="../index.html" class="text-accent-purple font-bold text-lg hover:text-purple-700 transition-colors">Felix Aertebjerg</a>
                <div class="flex space-x-6">
                    <a href="../index.html" class="text-slate-600 hover:text-accent-purple transition-colors">Home</a>
                    <a href="index.html" class="text-slate-600 hover:text-accent-purple transition-colors">Blog</a>
                    <a href="../index.html#about" class="text-slate-600 hover:text-accent-purple transition-colors">About</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-4xl mx-auto px-4 py-8">
        <!-- Article Header -->
        <header class="mb-8">
            <div class="flex items-center gap-4 text-sm text-slate-600 mb-4">
                <time datetime="2024-12-20">December 20, 2024</time>
                <span class="flex items-center gap-1">
                    <i class="fa-solid fa-tags"></i>
                    <span>Chemistry, GNNs, Drug Discovery</span>
                </span>
                <span class="text-slate-400">‚Ä¢</span>
                <span>10 min read</span>
            </div>
            <h1 class="font-space-grotesk text-4xl font-bold text-slate-900 mb-6 leading-tight">
                Graph Neural Networks for Molecular Property Prediction
            </h1>
            <p class="text-xl text-slate-600 leading-relaxed">
                Molecular property prediction is a crucial task in drug discovery and materials science.
                Graph Neural Networks (GNNs) have revolutionized this field by learning directly from molecular structures,
                offering a natural way to represent and process chemical data.
            </p>
        </header>

        <!-- Article Content -->
        <article class="prose prose-lg max-w-none">
            <h4 class="font-space-grotesk text-2xl font-semibold text-slate-800 mb-4">The Molecular Representation Challenge</h4>
            <p>
                Traditional machine learning approaches to molecular property prediction often rely on hand-crafted descriptors
                or simplified representations like SMILES strings. However, molecules are inherently graph-structured:
                atoms connected by bonds with rich chemical properties.
            </p>
            <p>
                Graph Neural Networks provide a natural framework for learning from this structured data,
                capturing both local chemical environments and global molecular properties.
            </p>

            <h4 class="font-space-grotesk text-2xl font-semibold text-slate-800 mb-4">Message Passing in GNNs</h4>
            <p>
                The core innovation of GNNs is the message passing framework, where information flows between
                connected nodes (atoms) through their bonds (edges).
            </p>

            <div class="bg-slate-50 p-6 rounded-lg my-8 border-l-4 border-accent-cyan">
                <p class="text-sm text-slate-600 mb-2 font-medium">The message passing equation:</p>
                <div class="text-center text-lg font-mono bg-white p-4 rounded border">\(
                    \mathbf{h}_v^{(k)} = \text{UPDATE}^{(k)}\left( \mathbf{h}_v^{(k-1)}, \bigoplus_{u \in \mathcal{N}(v)} \text{MESSAGE}^{(k)}\left( \mathbf{h}_v^{(k-1)}, \mathbf{h}_u^{(k-1)}, \mathbf{e}_{vu} \right) \right)
                \)</div>
            </div>

            <h4 class="font-space-grotesk text-2xl font-semibold text-slate-800 mb-4">Implementation with PyTorch Geometric</h4>
            <p>
                PyTorch Geometric provides an excellent framework for implementing GNNs on molecular data.
                Here's a simple example of a molecular property predictor:
            </p>

            <pre class="language-python"><code>import torch
import torch.nn.functional as F
from torch_geometric.nn import GCNConv, global_mean_pool

class MolecularGNN(torch.nn.Module):
    def __init__(self, num_features, hidden_channels, num_classes):
        super().__init__()
        self.conv1 = GCNConv(num_features, hidden_channels)
        self.conv2 = GCNConv(hidden_channels, hidden_channels)
        self.conv3 = GCNConv(hidden_channels, num_classes)
        self.lin = torch.nn.Linear(num_classes, 1)  # For regression

    def forward(self, x, edge_index, batch):
        # Node embeddings
        x = self.conv1(x, edge_index)
        x = F.relu(x)
        x = F.dropout(x, p=0.5, training=self.training)

        x = self.conv2(x, edge_index)
        x = F.relu(x)

        x = self.conv3(x, edge_index)

        # Global pooling
        x = global_mean_pool(x, batch)

        # Final prediction
        x = self.lin(x)
        return x</code></pre>

            <div class="my-8">
                <img src="https://via.placeholder.com/800x400/06b6d4/ffffff?text=Molecular+Graph+Representation" alt="Molecular structure represented as a graph" class="w-full rounded-lg shadow-lg">
                <p class="text-sm text-slate-600 mt-3 text-center italic">Figure 1: Aspirin molecule represented as a graph with atoms as nodes and bonds as edges</p>
            </div>

            <h4 class="font-space-grotesk text-2xl font-semibold text-slate-800 mb-4">Advanced Architectures</h4>
            <p>
                Beyond basic GCNs, several advanced architectures have been developed for molecular property prediction:
            </p>

            <ul class="space-y-3 mb-6">
                <li><strong>Graph Attention Networks (GATs):</strong> Use attention mechanisms to weigh neighbor importance</li>
                <li><strong>Graph Transformers:</strong> Apply transformer attention to graph structures</li>
                <li><strong>3D GNNs:</strong> Incorporate spatial information for 3D molecular conformations</li>
                <li><strong>Pre-trained GNNs:</strong> Large-scale pre-training on chemical databases for transfer learning</li>
            </ul>

            <h4 class="font-space-grotesk text-2xl font-semibold text-slate-800 mb-4">Applications in Drug Discovery</h4>
            <p>
                GNNs have found numerous applications in pharmaceutical research:
            </p>

            <div class="grid md:grid-cols-2 gap-6 my-8">
                <div class="bg-slate-50 p-6 rounded-lg">
                    <h5 class="font-semibold text-slate-800 mb-2">Property Prediction</h5>
                    <p class="text-sm text-slate-600">Predicting solubility, toxicity, and pharmacokinetic properties</p>
                </div>
                <div class="bg-slate-50 p-6 rounded-lg">
                    <h5 class="font-semibold text-slate-800 mb-2">Virtual Screening</h5>
                    <p class="text-sm text-slate-600">Identifying potential drug candidates from large chemical libraries</p>
                </div>
                <div class="bg-slate-50 p-6 rounded-lg">
                    <h5 class="font-semibold text-slate-800 mb-2">Molecular Design</h5>
                    <p class="text-sm text-slate-600">Generating novel molecules with desired properties</p>
                </div>
                <div class="bg-slate-50 p-6 rounded-lg">
                    <h5 class="font-semibold text-slate-800 mb-2">Reaction Prediction</h5>
                    <p class="text-sm text-slate-600">Predicting chemical reaction outcomes and mechanisms</p>
                </div>
            </div>

            <div class="bg-green-50 border-l-4 border-accent-cyan p-6 my-8">
                <h5 class="font-space-grotesk font-semibold text-accent-cyan mb-2">üî¨ Impact on Research</h5>
                <p class="text-slate-700">
                    GNNs have accelerated drug discovery timelines and reduced experimental costs by providing
                    fast, accurate predictions of molecular properties. This has enabled researchers to focus
                    experimental resources on the most promising candidates.
                </p>
            </div>

            <h4 class="font-space-grotesk text-2xl font-semibold text-slate-800 mb-4">Challenges and Future Directions</h4>
            <p>
                Despite their success, GNNs for molecular prediction face several challenges:
            </p>

            <ul class="space-y-2 mb-6">
                <li><strong>Scalability:</strong> Handling very large molecules and datasets</li>
                <li><strong>3D Structure:</strong> Incorporating conformational information effectively</li>
                <li><strong>Interpretability:</strong> Understanding model predictions for chemical design</li>
                <li><strong>Data Quality:</strong> Dealing with noisy and incomplete chemical databases</li>
            </ul>

            <p>
                Future developments in equivariant GNNs, large-scale pre-training, and multi-modal learning
                promise to address these challenges and further expand the capabilities of molecular machine learning.
            </p>
        </article>

        <!-- Article Footer -->
        <footer class="mt-12 pt-8 border-t border-slate-200">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                <div class="flex items-center gap-4">
                    <a href="index.html" class="text-accent-purple hover:text-purple-700 transition-colors">
                        ‚Üê Back to Blog
                    </a>
                </div>
                <div class="flex items-center gap-4 text-sm text-slate-600">
                    <span>Share:</span>
                    <a href="#" class="hover:text-accent-blue transition-colors">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" class="hover:text-accent-blue transition-colors">
                        <i class="fab fa-linkedin"></i>
                    </a>
                    <a href="#" class="hover:text-accent-purple transition-colors">
                        <i class="fas fa-link"></i>
                    </a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Footer -->
    <footer class="mt-16 bg-slate-900 text-white">
        <div class="max-w-4xl mx-auto px-4 py-8">
            <div class="text-center">
                <p class="text-slate-400 mb-4">¬© 2025 Felix Aertebjerg. All rights reserved.</p>
                <div class="flex justify-center space-x-6">
                    <a href="../index.html" class="text-slate-400 hover:text-white transition-colors">Home</a>
                    <a href="index.html" class="text-slate-400 hover:text-white transition-colors">Blog</a>
                    <a href="https://github.com/aerte" class="text-slate-400 hover:text-white transition-colors">GitHub</a>
                    <a href="https://linkedin.com/in/yourusername" class="text-slate-400 hover:text-white transition-colors">LinkedIn</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Prism.js for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>